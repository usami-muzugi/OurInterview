# 准备

准备（ Preparation）阶段的任务是为类或接口的静态字段分配空间，并用默认值初始化这些字段（ §2.3， §2.4）。这个阶段不会执行任何的虚拟机字节码指令。在初始化阶段（ §5.5）会有显式的初始化器来初始化这些静态字段，所以准备阶段不做这些事情。
在某个类或接口 C 的准备阶段， Java 虚拟机也会强制进行加载约束（ §5.3.4）。假定 L1是 C 的定义加载器。对于每个声明在 C 中的方法 m，它重写（ §5.4.5）声明在 C 的父类或父接口<D， L2>中的某个方法， Java 虚拟机强制执行下面的加载约束：

* 给定 m 的返回值类型是 Tr，
* 并且给定 m 的形参类型从 Tf1，„， Tfn，
* 如果 Tr 不是数组类型，那么 T0 代替 Tr；不然的话， T0 就可以表示 Tr 的元素类型（ §2.4）。
* 由 i 表示 1 到 n，如果 Tfi 不是数组类型， Ti 就表示 Tfi；不然， Ti 就是 Tfi 的元素类型（ §2.4）。
* 那么对于 i = 0„n， Ti L1 = Ti L 2 就应该成立（ §5.3.4）。

此外，如果 C 实现了它的父接口<I， L3>中的方法 m，但 C 自己是没有这个方法 m 声明的，如果 C 有父类<D， L2>，它声明实现了由 C 继承的那个方法 m。 Java 虚拟机强制执行下面的约束：
给定 m 的返回值类型是 Tr，并且给定 m 的形参类型从 Tf1，„， Tfn，如果 Tr 不是数组类型，那么 T0 代替 Tr； 不然的话， T0 就可以表示 Tr 的元素类型（ §2.4）。由 i 表示 1 到 n，如果 Tfi 不是数组类型， Ti 就表示 Tfi；不然， Ti 就是 Tfi 的元素类型（ §2.4）。那么对于 i =0...n，Til2=TiL3 就应该成立（ §5.3.4）。 

在类的对象创建之后的任何时间，都可以进行准备阶段，但它得确保一定要在初始化阶段开始前完成。 